diff -Naur original/commons-fileupload-1.2.2-src/java/org/apache/commons/fileupload/MultipartStream.java patched/commons-fileupload-1.2.2-src/src/java/org/apache/commons/fileupload/MultipartStream.java
index 1eefefc..ddc7800 100644
--- original/commons-fileupload-1.2.2-src/src/java/org/apache/commons/fileupload/MultipartStream.java
--- patched/commons-fileupload-1.2.2-src/src/java/org/apache/commons/fileupload/MultipartStream.java
@@ -325,10 +325,6 @@ public class MultipartStream {
             byte[] boundary,
             int bufSize,
             ProgressNotifier pNotifier) {
-        this.input = input;
-        this.bufSize = bufSize;
-        this.buffer = new byte[bufSize];
-        this.notifier = pNotifier;
 
         // We prepend CR/LF to the boundary to chop trailng CR/LF from
         // body-data tokens.
@@ -337,6 +333,12 @@ public class MultipartStream {
             throw new IllegalArgumentException(
                     "The buffer size specified for the MultipartStream is too small");
         }
+
+        this.input = input;
+        this.bufSize = Math.max(bufSize, boundaryLength*2);
+        this.buffer = new byte[this.bufSize];
+        this.notifier = pNotifier;
+
         this.boundary = new byte[this.boundaryLength];
         this.keepRegion = this.boundary.length;
 