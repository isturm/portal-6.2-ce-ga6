$(function(){if(!assignedCreators){assignedCreators=""}showCreatorsList(assignedCreators)});function showCreatorsList(a){$.template("filesTemplate",$("#created"));$.tmpl("filesTemplate",a).appendTo("#creators")}function autocompleteCreator(d,b,a){avoidClosing=false;d.autocomplete({source:function(g,e){var f=$.ui.autocomplete.filter(allCreatorsInJQueryAutocompleteFormat,g.term);e(f.slice(0,10))},messages:{noResults:"",results:function(){}},minLength:1,open:function(e,f){$(".ui-autocomplete").append('<li id="addNewCreator" class="newcreator">'+Liferay.Language.get("add-new-creator")+' <span class="icon-large icon-plus-sign"></span></li>');$("#addNewCreator").on("click",function(){d.val("");c++;appendCreator(c,a);d.autocomplete("close")})},response:function(e,f){if(f.content.length===0){avoidClosing=true}},close:function(e,f){if(avoidClosing){$("ul.ui-autocomplete li:not(:last)").remove();$("ul.ui-autocomplete").show();avoidClosing=false}},select:function(e,f){hasFormChanged=true;if(f.item.id>0){var g=getJSONCreator(f.item.id);$.template("filesTemplate",$("#created"));$.tmpl("filesTemplate",g).appendTo("#creators");if(typeof a=="function"){a()}f.item.value=""}}})}function appendCreator(b,a){$(function(){var d={counter:b};$.template("filesTemplate",$("#newCreator"));$.tmpl("filesTemplate",d).appendTo("#creators");$("#nc"+b).keyup(function(){if(typeof a=="function"){a()}});$("#nc"+b).on("keypress",function(e){if(e.which==13){updateCreators()}})})}function getJSONCreator(b){var a;var e=namespace+"creatorId";var d={};d[e]=b;$.ajax({type:"POST",url:getJSONCreatorURL,dataType:"json",data:d,global:false,async:false,success:function(f){a=f}});return a}function getJSONAllCreators(d){var a;var b=namespace+"videoId";var e={};e[b]=d;console.log(e);$.ajax({type:"POST",url:getJSONAllCreatorsURL,dataType:"json",data:e,global:false,async:false,success:function(f){a=f}});console.log(a);return a}var creatorsArray=[];function getJsonCreatorsArray(){loadCreators();return creatorsArray}function updateCreators(){loadCreators();updateCreatorOnServer(creatorsArray)}var creatorsArray=[];function loadCreators(){creatorsArray=[];$("#creators").children().each(function(e){var b={};var a=$(this);var d=a.attr("id");if(d.indexOf("nc")==-1){b.creatorId=a.find("input[name = "+namespace+"creatorId]").val();b.firstName=a.find("input[name = "+namespace+"firstName]").val();b.lastName=a.find("input[name = "+namespace+"lastName]").val();b.middleName=a.find("input[name = "+namespace+"middleName]").val();b.jobTitle=a.find("input[name = "+namespace+"jobTitle]").val();b.gender="";b.fullName=a.find("input[name = "+namespace+"fullName]").val();b.affiliation=a.find("input[name = "+namespace+"affiliation]").val();b.orcidId=a.find("input[name = "+namespace+"orcidId]").val()}else{b.creatorId="0";b.firstName=a.find("input[name = "+namespace+"firstName]").val().trim();b.lastName=a.find("input[name = "+namespace+"lastName]").val().trim();b.middleName=a.find("input[name = "+namespace+"middleName]").val().trim();b.jobTitle=a.find("input[name = "+namespace+"jobTitle]").val().trim();b.gender="";b.fullName=(b.jobTitle.trim()+" "+(b.firstName.trim()+" "+b.middleName.trim()).trim()+" "+b.lastName.trim()).trim();b.affiliation=a.find("input[name = "+namespace+"affiliation]").val();b.orcidId=a.find("input[name = "+namespace+"orcidId]").val()}if(b.firstName.length>0&&b.lastName.length>0){creatorsArray[e]=b}})};